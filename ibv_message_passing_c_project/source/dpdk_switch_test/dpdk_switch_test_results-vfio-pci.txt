0. Introduction
~~~~~~~~~~~~~~~

For this using:
a. HP Z4 G4 PC
b. AlmaLinux 8.7
c. DPDK 21.11.0 packaged by AlmaLinux

When booted temporarily added intel_iommu=on to the command line, to allow DPDK to use vfio-pci to bind to a QL41112HxCU-DE:
[mr_halfword@skylake-alma release]$ cat /proc/cmdline 
BOOT_IMAGE=(hd1,gpt2)/vmlinuz-4.18.0-425.3.1.el8.x86_64 root=/dev/mapper/almalinux_skylake--alma-root ro resume=/dev/mapper/almalinux_skylake--alma-swap rd.lvm.lv=almalinux_skylake-alma/root rd.lvm.lv=almalinux_skylake-alma/swap rhgb quiet intel_iommu=on


State of the network devices, after binding vfio-pci to some:
[mr_halfword@skylake-alma ~]$ dpdk-devbind.py --status

Network devices using DPDK-compatible driver
============================================
0000:00:1f.6 'Ethernet Connection (2) I219-LM 15b7' drv=vfio-pci unused=e1000e
0000:02:00.0 'I210 Gigabit Network Connection 1533' drv=vfio-pci unused=igb
0000:2d:00.0 'FastLinQ QL41000 Series 10/25/40/50GbE Controller 8070' drv=vfio-pci unused=qede
0000:2d:00.1 'FastLinQ QL41000 Series 10/25/40/50GbE Controller 8070' drv=vfio-pci unused=qede

Network devices using kernel driver
===================================
0000:21:00.0 'MT27710 Family [ConnectX-4 Lx] 1015' if=ens1f0 drv=mlx5_core unused=vfio-pci 
0000:21:00.1 'MT27710 Family [ConnectX-4 Lx] 1015' if=ens1f1 drv=mlx5_core unused=vfio-pci 

No 'Baseband' devices detected
==============================

No 'Crypto' devices detected
============================

DMA devices using kernel driver
===============================
0000:00:04.0 'Sky Lake-E CBDMA Registers 2021' drv=ioatdma unused=vfio-pci 
0000:00:04.1 'Sky Lake-E CBDMA Registers 2021' drv=ioatdma unused=vfio-pci 
0000:00:04.2 'Sky Lake-E CBDMA Registers 2021' drv=ioatdma unused=vfio-pci 
0000:00:04.3 'Sky Lake-E CBDMA Registers 2021' drv=ioatdma unused=vfio-pci 
0000:00:04.4 'Sky Lake-E CBDMA Registers 2021' drv=ioatdma unused=vfio-pci 
0000:00:04.5 'Sky Lake-E CBDMA Registers 2021' drv=ioatdma unused=vfio-pci 
0000:00:04.6 'Sky Lake-E CBDMA Registers 2021' drv=ioatdma unused=vfio-pci 
0000:00:04.7 'Sky Lake-E CBDMA Registers 2021' drv=ioatdma unused=vfio-pci 

No 'Eventdev' devices detected
==============================

No 'Mempool' devices detected
=============================

No 'Compress' devices detected
==============================

No 'Misc (rawdev)' devices detected
===================================

No 'Regex' devices detected
===========================

Where:
a. I219-LM and I210 are onboard 1G network interfaces
b. MT27710 Family [ConnectX-4 Lx] 1015' is a dual port ConnectX-4 Lx En with 10G ports
c. 'FastLinQ QL41000 Series 10/25/40/50GbE Controller 8070' is a dual port QL41112HxCU-DE with 10G ports

For these initial tests just using the 10G ports 25 and 26 looped-back on a tp-link T1700G-28TQ switch.

Huge pages had been configured:
[mr_halfword@skylake-alma switch_test]$ dpdk-hugepages.py --show
Node Pages Size Total
0    512   2Mb    1Gb

Hugepages mounted on /dev/hugepages


1. I210 on-board 1G error free when using huge pages
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[mr_halfword@skylake-alma release]$ sudo dpdk_switch_test/dpdk_switch_test -l 3-4 -a 0000:02:00.0 -- -p 25-26 -r 1000 
EAL: Detected CPU lcores: 8
EAL: Detected NUMA nodes: 1
EAL: Detected shared linkage of DPDK
EAL: Multi-process socket /var/run/dpdk/rte/mp_socket
EAL: Selected IOVA mode 'VA'
EAL: No available 1048576 kB hugepages reported
EAL: VFIO support initialized
EAL: Using IOMMU type 1 (Type 1)
EAL: Ignore mapping IO port bar(2)
EAL: Probe PCI driver: net_e1000_igb (8086:1533) device: 0000:02:00.0 (socket 0)
TELEMETRY: No legacy callbacks, legacy socket not created
Using DPDK driver_name=net_e1000_igb device_name=0000:02:00.0
tx_num_descriptors : desired=2 actual=32
rx_num_descriptors : desired=3312 actual=3312
Waiting to get link speed (link needs to be up). Press Ctrl-C to abort.
Waiting 2 seconds after link came up for switch to accept packets
Bit rate on interface to injection switch = 1000 (Mbps)
Requested bit rate to be generated on each switch port under test = 1000.00 (Mbps)
Not limiting frame rate, as bit-rate on interface to injection switch doesn't exceed the total across all switch ports under test
Writing per-port counts to 20221221T224401_per_port_counts_linux.csv
Test interval = 10 (secs)
Frame debug enabled = No
Press Ctrl-C to stop test at end of next test interval

22:44:16.190
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       810668         810626              0              0              6              0        81066.8         500.02

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:44:26.190
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       810641         810641              0              0              5              0        81064.1         500.00

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:44:36.190
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       810641         810641              0              0              5              0        81064.1         500.00

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:44:46.190
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       810641         810641              0              0              5              0        81064.1         500.00

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:44:56.190
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       810640         810641              0              0              5              0        81064.0         500.00

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:45:06.190
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       810641         810641              0              0              5              0        81064.1         500.00

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0
^C
22:45:16.190
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       810641         810641              0              0              5              0        81064.1         500.00

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0
Max pending rx frames = 21 out of 1656

DPDK Ethernet statistics:
  Total number of successfully received packets    : 5674519
  Total number of successfully transmitted packets : 5674486
  Total number of successfully received bytes      : 8613870334
  Total number of successfully transmitted bytes   : 8613871270
  Total of Rx packets dropped by the HW            : 0
  Total number of erroneous received packets       : 0
  Total number of failed transmitted packets       : 0
  Total number of Rx mbuf allocation failures      : 0



2. I210 on-board 1G error free when not using huge pages
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[mr_halfword@skylake-alma release]$ sudo dpdk_switch_test/dpdk_switch_test --no-huge -m 1024m -l 3-4 -a 0000:02:00.0 -- -p 25-26 -r 10000 -s
EAL: Detected CPU lcores: 8
EAL: Detected NUMA nodes: 1
EAL: Detected shared linkage of DPDK
EAL: Multi-process socket /var/run/dpdk/rte/mp_socket
EAL: Selected IOVA mode 'VA'
EAL: VFIO support initialized
EAL: Using IOMMU type 1 (Type 1)
EAL: Ignore mapping IO port bar(2)
EAL: Probe PCI driver: net_e1000_igb (8086:1533) device: 0000:02:00.0 (socket 0)
TELEMETRY: No legacy callbacks, legacy socket not created
Using DPDK driver_name=net_e1000_igb device_name=0000:02:00.0
tx_num_descriptors : desired=2 actual=32
rx_num_descriptors : desired=3312 actual=3312
Waiting to get link speed (link needs to be up). Press Ctrl-C to abort.
Waiting 2 seconds after link came up for switch to accept packets
Bit rate on interface to injection switch = 1000 (Mbps)
Requested bit rate to be generated on each switch port under test = 10000.00 (Mbps)
Not limiting frame rate, as bit-rate on interface to injection switch doesn't exceed the total across all switch ports under test
Writing per-port counts to 20221223T223152_per_port_counts_linux.csv
Test interval = 10 (secs)
Frame debug enabled = No
Sanity checks enabled = Yes
Press Ctrl-C to stop test at end of next test interval

22:32:07.819
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       810667         810626              0              0              0              0        81066.7         500.02

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:32:17.819
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       810641         810641              0              0              0              0        81064.1         500.00

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:32:27.819
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       810641         810641              0              0              0              0        81064.1         500.00

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0
^C
22:32:37.819
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       810641         810641              0              0              0              0        81064.1         500.00

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0
Max pending rx frames = 21 out of 1656

DPDK Ethernet statistics:
  Total number of successfully received packets    : 3242558
  Total number of successfully transmitted packets : 3242561
  Total number of successfully received bytes      : 4922206088
  Total number of successfully transmitted bytes   : 4922209120
  Total of Rx packets dropped by the HW            : 0
  Total number of erroneous received packets       : 0
  Total number of failed transmitted packets       : 0
  Total number of Rx mbuf allocation failures      : 0


3. ConnectX-4 Lx error free when using huge pages
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[mr_halfword@skylake-alma release]$ sudo dpdk_switch_test/dpdk_switch_test -l 3-4 -a 0000:21:00.1 -- -p 25-26 -r 10000
EAL: Detected CPU lcores: 8
EAL: Detected NUMA nodes: 1
EAL: Detected shared linkage of DPDK
EAL: Multi-process socket /var/run/dpdk/rte/mp_socket
EAL: Selected IOVA mode 'VA'
EAL: No available 1048576 kB hugepages reported
EAL: VFIO support initialized
EAL: Probe PCI driver: mlx5_pci (15b3:1015) device: 0000:21:00.1 (socket 0)
mlx5_net: No available register for sampler.
TELEMETRY: No legacy callbacks, legacy socket not created
Using DPDK driver_name=mlx5_pci device_name=0000:21:00.1
mlx5_net: port 0 number of descriptors requested for Tx queue 0 must be higher than MLX5_TX_COMP_THRESH, using 33 instead of 2
mlx5_net: port 0 increased number of descriptors in Tx queue 0 to the next power of two (64)
rte_eth_tx_queue_info_get() changed number of Tx descriptors from 2 to 64
tx_num_descriptors : desired=2 actual=64
rx_num_descriptors : desired=3312 actual=4096
Bit rate on interface to injection switch = 10000 (Mbps)
Requested bit rate to be generated on each switch port under test = 10000.00 (Mbps)
Not limiting frame rate, as bit-rate on interface to injection switch doesn't exceed the total across all switch ports under test
Writing per-port counts to 20221221T224908_per_port_counts_linux.csv
Test interval = 10 (secs)
Frame debug enabled = No
Press Ctrl-C to stop test at end of next test interval

22:49:18.993
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8100484        8100401              0              0              5              0       810048.4        4996.38

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:49:28.993
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8101396        8101400              0              0              5              0       810139.6        4996.94

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:49:38.993
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8101448        8101439              0              0              9              0       810144.8        4996.97

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:49:48.993
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8100424        8100426              0              0              8              0       810042.4        4996.34

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:49:58.993
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8101005        8101015              0              0              5              0       810100.5        4996.70

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:50:08.993
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8101339        8101333              0              0              5              0       810133.9        4996.91

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:50:18.993
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8101553        8101556              0              0              5              0       810155.3        4997.04

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0
^C
22:50:28.993
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8101501        8101511              0              0              5              0       810150.1        4997.01

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0
Max pending rx frames = 45 out of 1656

DPDK Ethernet statistics:
  Total number of successfully received packets    : 64809128
  Total number of successfully transmitted packets : 64809150
  Total number of successfully received bytes      : 98380188408
  Total number of successfully transmitted bytes   : 98380289700
  Total of Rx packets dropped by the HW            : 0
  Total number of erroneous received packets       : 0
  Total number of failed transmitted packets       : 0
  Total number of Rx mbuf allocation failures      : 0


4. ConnectX-4 Lx error free when not using huge pages
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[mr_halfword@skylake-alma release]$ sudo dpdk_switch_test/dpdk_switch_test --no-huge -m 1024m -l 3-4 -a 0000:21:00.1 -- -p 25-26 -r 10000 -s
EAL: Detected CPU lcores: 8
EAL: Detected NUMA nodes: 1
EAL: Detected shared linkage of DPDK
EAL: Multi-process socket /var/run/dpdk/rte/mp_socket
EAL: Selected IOVA mode 'VA'
EAL: VFIO support initialized
EAL: Probe PCI driver: mlx5_pci (15b3:1015) device: 0000:21:00.1 (socket 0)
mlx5_net: No available register for sampler.
TELEMETRY: No legacy callbacks, legacy socket not created
Using DPDK driver_name=mlx5_pci device_name=0000:21:00.1
mlx5_net: port 0 number of descriptors requested for Tx queue 0 must be higher than MLX5_TX_COMP_THRESH, using 33 instead of 2
mlx5_net: port 0 increased number of descriptors in Tx queue 0 to the next power of two (64)
rte_eth_tx_queue_info_get() changed number of Tx descriptors from 2 to 64
tx_num_descriptors : desired=2 actual=64
rx_num_descriptors : desired=3312 actual=4096
Bit rate on interface to injection switch = 10000 (Mbps)
Requested bit rate to be generated on each switch port under test = 10000.00 (Mbps)
Not limiting frame rate, as bit-rate on interface to injection switch doesn't exceed the total across all switch ports under test
Writing per-port counts to 20221223T224205_per_port_counts_linux.csv
Test interval = 10 (secs)
Frame debug enabled = No
Sanity checks enabled = Yes
Press Ctrl-C to stop test at end of next test interval

22:42:15.816
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8099976        8099903              0              0              0              0       809997.6        4996.07

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:42:25.816
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8101696        8101688              0              0              0              0       810169.6        4997.13

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:42:35.816
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8102208        8102207              0              0              0              0       810220.8        4997.44

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:42:45.816
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8101936        8101941              0              0              0              0       810193.6        4997.27

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:42:55.816
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8097115        8097110              0              0              0              0       809711.5        4994.30

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:43:05.816
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8099005        8099006              0              0              0              0       809900.5        4995.47

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0
^C
22:43:15.816
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8102176        8102188              0              0              0              0       810217.6        4997.42

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0
Max pending rx frames = 45 out of 1656

DPDK Ethernet statistics:
  Total number of successfully received packets    : 56704043
  Total number of successfully transmitted packets : 56704111
  Total number of successfully received bytes      : 86076737274
  Total number of successfully transmitted bytes   : 86076840498
  Total of Rx packets dropped by the HW            : 0
  Total number of erroneous received packets       : 0
  Total number of failed transmitted packets       : 0
  Total number of Rx mbuf allocation failures      : 0


5. QL41112HxCU-DE errors when using huge pages
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Looks like something goes wrong with the receive ring:
a. Stop receiving any more packets after almost 4096 (the number of descriptors)
b. Looks like receive the expected packet, followed by a packet of the write length but with the data
   of the previous packet shifted. Perhaps a bug in segmented packets?

Debugging, with the switch ports used for the test not being a member of the system VLAN to isolate them
from next test trafic shows the sequence:
1. Zero mbufs from rte_eth_rx_burst ()
2. Transmit frame with sequence number 1.
3. One mbuf from rte_eth_rx_burst (), which is test frame with sequence number 1.
rx_pkt->data_len    uint16_t    1472    
rx_pkt->pkt_len uint32_t    1518    
rx_pkt->nb_segs uint16_t    2   
rx_pkt->next    struct rte_mbuf *   0x0 
rx_pkt->data_off    uint16_t    128 
4. Transmit frame with sequence number 2.
5. One mbuf from rte_eth_rx_burst (), which has the expected pkt_len but the contents aren't a test frame.
   frame->Length=1460. Expected Length is 1498.
rx_pkt->data_len    uint16_t    1472    
rx_pkt->pkt_len uint32_t    1518    
rx_pkt->nb_segs uint16_t    2   
rx_pkt->next    struct rte_mbuf *   0x0 
rx_pkt->data_off    uint16_t    128 
6. Transmit frame with sequence number 3.
7. One mbuf from rte_eth_rx_burst (), which is test frame with sequence number 2.
rx_pkt->data_len    uint16_t    1472    
rx_pkt->pkt_len uint32_t    1518    
rx_pkt->nb_segs uint16_t    1   
rx_pkt->next    struct rte_mbuf *   0x0 
rx_pkt->data_off    uint16_t    128 
8. Transmit frame with sequence number 4.
9. One mbuf from rte_eth_rx_burst (), which has the expected pkt_len but the contents aren't a test frame.
   The contents looks to be offset from the test pattern, based on a sample of fields.
10. Transmit frame with sequehce number 5.
11. One mbuf from rte_eth_rx_burst (), which is test frame with sequence number 2.
rx_pkt->data_len    uint16_t    1472    
rx_pkt->pkt_len uint32_t    1518    
rx_pkt->nb_segs uint16_t    2   
rx_pkt->next    struct rte_mbuf *   0x0 
rx_pkt->data_off    uint16_t    128 


   Debugging shows can get a segmented packet, which dpdk_switch_test is not currently written to handle:
rx_pkt  const struct rte_mbuf * const   0x13e8a9040 
    cacheline0  RTE_MARKER  [0] 
    buf_addr    void *  0x13e8a90c0 
    buf_iova    rte_iova_t  5344235712  
    rearm_data  RTE_MARKER64    [0] 
    data_off    uint16_t    128 
    refcnt  uint16_t    1   
    nb_segs uint16_t    2   
    port    uint16_t    0   
    ol_flags    uint64_t    385 
    rx_descriptor_fields1   RTE_MARKER  [0] 
    packet_type uint32_t    0   
    l2_type uint8_t 0 '\0'  
    l3_type uint8_t 0 '\0'  
    l4_type uint8_t 0 '\0'  
    tun_type    uint8_t 0 '\0'  
    inner_esp_next_proto    uint8_t 0 '\0'  
    inner_l2_type   uint8_t 0 '\0'  
    inner_l3_type   uint8_t 0 '\0'  
    inner_l4_type   uint8_t 0 '\0'  
    pkt_len uint32_t    1518    
    data_len    uint16_t    1472    
    vlan_tci    uint16_t    0   
    hash    union {...} {...}   
    vlan_tci_outer  uint16_t    0   
    buf_len uint16_t    2176    
    pool    struct rte_mempool *    0x1408bb3c0 
    cacheline1  RTE_MARKER  [0] 
    next    struct rte_mbuf *   0x0 
    tx_offload  uint64_t    0   
    l2_len  uint64_t    0   
    l3_len  uint64_t    0   
    l4_len  uint64_t    0   
    tso_segsz   uint64_t    0   
    outer_l3_len    uint64_t    0   
    outer_l2_len    uint64_t    0   
    shinfo  struct rte_mbuf_ext_shared_info *   0x0 
    priv_size   uint16_t    0   
    timesync    uint16_t    0   
    dynfield1   uint32_t [9]    0x13e8a909c 


[mr_halfword@skylake-alma release]$ sudo dpdk_switch_test/dpdk_switch_test -l 3-4 -a 0000:2d:00.0 -- -p 25-26 -r 10000 -d
EAL: Detected CPU lcores: 8
EAL: Detected NUMA nodes: 1
EAL: Detected shared linkage of DPDK
EAL: Multi-process socket /var/run/dpdk/rte/mp_socket
EAL: Selected IOVA mode 'VA'
EAL: No available 1048576 kB hugepages reported
EAL: VFIO support initialized
EAL: Using IOMMU type 1 (Type 1)
EAL: Ignore mapping IO port bar(1)
EAL: Ignore mapping IO port bar(3)
EAL: Ignore mapping IO port bar(5)
EAL: Probe PCI driver: net_qede (1077:8070) device: 0000:2d:00.0 (socket 0)
TELEMETRY: No legacy callbacks, legacy socket not created
Using DPDK driver_name=net_qede device_name=0000:2d:00.0
tx_num_descriptors : desired=2 actual=256
rx_num_descriptors : desired=3312 actual=4096
Waiting to get link speed (link needs to be up). Press Ctrl-C to abort.
Waiting 2 seconds after link came up for switch to accept packets
Bit rate on interface to injection switch = 10000 (Mbps)
Requested bit rate to be generated on each switch port under test = 10000.00 (Mbps)
Not limiting frame rate, as bit-rate on interface to injection switch doesn't exceed the total across all switch ports under test
Writing per-port counts to 20221221T225605_per_port_counts_linux.csv
Test interval = 10 (secs)
Frame debug enabled = Yes
Running for a single test interval to collect debug information

22:56:17.513
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8106140           2042              2              0           2047        8100786       810614.0        4999.87

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   S
    26  S 
Total test intervals with failures = 1 : last failure NOW
Max pending rx frames = 1656 out of 1656

DPDK Ethernet statistics:
  Total number of successfully received packets    : 4090
  Total number of successfully transmitted packets : 8105996
  Total number of successfully received bytes      : 6223522
  Total number of successfully transmitted bytes   : 12337321346
  Total of Rx packets dropped by the HW            : 8101848
  Total number of erroneous received packets       : 0
  Total number of failed transmitted packets       : 0
  Total number of Rx mbuf allocation failures      : 8101848
[qede_drain_txq:964(2d:00.0:dpdk-port-0)]Tx queue[0] is stuck,requesting MCP to drain
[qede_drain_txq:973(2d:00.0:dpdk-port-0)]Timeout waiting for tx queue[0]:PROD=45211, CONS=155
[QEDE PMD: (2d:00.0:dpdk-port-0-0)]ecore_spq_block:Ramrod is stuck [CID ff000000 cmd 03 proto 04 echo 000d]
[qede_hw_err_notify:330(2d:00.0:dpdk-port-0-0)]HW error occurred [Ramrod Failure]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs_len:Calculating idle_chk and grcdump register length for current engine
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs_len:Total length = 2356504
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:obtaining idle_chk and grcdump for current engine
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:Idle Check1 feature_size 2732
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:Idle Check2 feature_size 2732
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["reg_fifo"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:Reg fifo feature_size 5792
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["igu_fifo"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:IGU fifo feature_size 240
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["protection_override"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:Protection override feature_size 2380
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["fw_asserts"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:FW assert feature_size 788
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["grc"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:GRC dump feature_size 2119996
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["mcp_trace"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_nvram_read:nvram_read: reading image of size 108336 bytes from NVRAM
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:MCP trace feature_size 14840
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_save_fw_dump:FW dump written to qede_pmd_dump_12-21-2022_22-56-28.bin file
[qede_stop_vport:458(2d:00.0:dpdk-port-0)]Stop V-PORT failed rc = -2
[QEDE PMD: (2d:00.0:dpdk-port-0-0)]ecore_spq_block:Ramrod is stuck [CID ff000000 cmd 02 proto 08 echo 000e]
[qede_hw_err_notify:330(2d:00.0:dpdk-port-0-0)]HW error occurred [Ramrod Failure]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs_len:Calculating idle_chk and grcdump register length for current engine
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs_len:Total length = 2356504
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:obtaining idle_chk and grcdump for current engine
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:Idle Check1 feature_size 3640
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:Idle Check2 feature_size 3640
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["reg_fifo"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:Reg fifo feature_size 5792
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["igu_fifo"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:IGU fifo feature_size 240
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["protection_override"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:Protection override feature_size 2380
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["fw_asserts"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:FW assert feature_size 788
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["grc"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:GRC dump feature_size 2119996
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["mcp_trace"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_nvram_read:nvram_read: reading image of size 108336 bytes from NVRAM
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:MCP trace feature_size 14860
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_save_fw_dump:FW dump written to qede_pmd_dump_12-21-2022_22-56-32.bin file
[QEDE PMD: (2d:00.0:dpdk-port-0-0)]ecore_hw_stop:Failed to close PF against FW [rc = -2]. Continue to stop HW to prevent illegal host access by the device.


6. QL41112HxCU-DE errors when using not using huge pages
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[mr_halfword@skylake-alma release]$ sudo dpdk_switch_test/dpdk_switch_test --no-huge -m 1024m -l 3-4 -a 0000:2d:00.0 -- -p 25-26 -r 10000 -d
EAL: Detected CPU lcores: 8
EAL: Detected NUMA nodes: 1
EAL: Detected shared linkage of DPDK
EAL: Multi-process socket /var/run/dpdk/rte/mp_socket
EAL: Selected IOVA mode 'VA'
EAL: VFIO support initialized
EAL: Using IOMMU type 1 (Type 1)
EAL: Ignore mapping IO port bar(1)
EAL: Ignore mapping IO port bar(3)
EAL: Ignore mapping IO port bar(5)
EAL: Probe PCI driver: net_qede (1077:8070) device: 0000:2d:00.0 (socket 0)
TELEMETRY: No legacy callbacks, legacy socket not created
Using DPDK driver_name=net_qede device_name=0000:2d:00.0
tx_num_descriptors : desired=2 actual=256
rx_num_descriptors : desired=3312 actual=4096
Waiting to get link speed (link needs to be up). Press Ctrl-C to abort.
Waiting 2 seconds after link came up for switch to accept packets
Bit rate on interface to injection switch = 10000 (Mbps)
Requested bit rate to be generated on each switch port under test = 10000.00 (Mbps)
Not limiting frame rate, as bit-rate on interface to injection switch doesn't exceed the total across all switch ports under test
Writing per-port counts to 20221221T225812_per_port_counts_linux.csv
Test interval = 10 (secs)
Frame debug enabled = Yes
Running for a single test interval to collect debug information

22:58:24.425
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8106111           2042              2              0           2047        8100757       810611.1        4999.85

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   S
    26  S 
Total test intervals with failures = 1 : last failure NOW
Max pending rx frames = 1656 out of 1656

DPDK Ethernet statistics:
  Total number of successfully received packets    : 4090
  Total number of successfully transmitted packets : 8105994
  Total number of successfully received bytes      : 6223522
  Total number of successfully transmitted bytes   : 12337316780
  Total of Rx packets dropped by the HW            : 8101846
  Total number of erroneous received packets       : 0
  Total number of failed transmitted packets       : 0
  Total number of Rx mbuf allocation failures      : 8101846
[qede_drain_txq:964(2d:00.0:dpdk-port-0)]Tx queue[0] is stuck,requesting MCP to drain
[qede_drain_txq:973(2d:00.0:dpdk-port-0)]Timeout waiting for tx queue[0]:PROD=45183, CONS=127
[QEDE PMD: (2d:00.0:dpdk-port-0-0)]ecore_spq_block:Ramrod is stuck [CID ff000000 cmd 03 proto 04 echo 000d]
[qede_hw_err_notify:330(2d:00.0:dpdk-port-0-0)]HW error occurred [Ramrod Failure]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs_len:Calculating idle_chk and grcdump register length for current engine
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs_len:Total length = 2356504
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:obtaining idle_chk and grcdump for current engine
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:Idle Check1 feature_size 2732
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:Idle Check2 feature_size 2732
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["reg_fifo"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:Reg fifo feature_size 5792
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["igu_fifo"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:IGU fifo feature_size 240
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["protection_override"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:Protection override feature_size 2380
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["fw_asserts"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:FW assert feature_size 788
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["grc"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:GRC dump feature_size 2119996
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["mcp_trace"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_nvram_read:nvram_read: reading image of size 108336 bytes from NVRAM
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:MCP trace feature_size 14640
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_save_fw_dump:FW dump written to qede_pmd_dump_12-21-2022_22-58-35.bin file
[qede_stop_vport:458(2d:00.0:dpdk-port-0)]Stop V-PORT failed rc = -2
[QEDE PMD: (2d:00.0:dpdk-port-0-0)]ecore_spq_block:Ramrod is stuck [CID ff000000 cmd 02 proto 08 echo 000e]
[qede_hw_err_notify:330(2d:00.0:dpdk-port-0-0)]HW error occurred [Ramrod Failure]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs_len:Calculating idle_chk and grcdump register length for current engine
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs_len:Total length = 2356504
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:obtaining idle_chk and grcdump for current engine
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:Idle Check1 feature_size 3640
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:Idle Check2 feature_size 3640
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["reg_fifo"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:Reg fifo feature_size 5792
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["igu_fifo"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:IGU fifo feature_size 240
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["protection_override"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:Protection override feature_size 2380
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["fw_asserts"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:FW assert feature_size 788
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["grc"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:GRC dump feature_size 2119996
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["mcp_trace"]
[QEDE PMD: (2d:00.0:dpdk-port-0)]qed_nvram_read:nvram_read: reading image of size 108336 bytes from NVRAM
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_get_regs:MCP trace feature_size 14648
[QEDE PMD: (2d:00.0:dpdk-port-0)]qede_save_fw_dump:FW dump written to qede_pmd_dump_12-21-2022_22-58-38.bin file
[QEDE PMD: (2d:00.0:dpdk-port-0-0)]ecore_hw_stop:Failed to close PF against FW [rc = -2]. Continue to stop HW to prevent illegal host access by the device.


7. QL41112HxCU-DE rte_mbuf_check() reports error on 1st received packet
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

When the -s command line option was used to enable calls to rte_mbuf_check() then fails on the first packet received:
[mr_halfword@skylake-alma release]$ sudo dpdk_switch_test/dpdk_switch_test --no-huge -m 1024m -l 3-4 -a 0000:2d:00.0 -- -p 25-26 -r 10000 -s
EAL: Detected CPU lcores: 8
EAL: Detected NUMA nodes: 1
EAL: Detected shared linkage of DPDK
EAL: Multi-process socket /var/run/dpdk/rte/mp_socket
EAL: Selected IOVA mode 'VA'
EAL: VFIO support initialized
EAL: Using IOMMU type 1 (Type 1)
EAL: Ignore mapping IO port bar(1)
EAL: Ignore mapping IO port bar(3)
EAL: Ignore mapping IO port bar(5)
EAL: Probe PCI driver: net_qede (1077:8070) device: 0000:2d:00.0 (socket 0)
TELEMETRY: No legacy callbacks, legacy socket not created
Using DPDK driver_name=net_qede device_name=0000:2d:00.0
tx_num_descriptors : desired=2 actual=256
rx_num_descriptors : desired=3312 actual=4096
Waiting to get link speed (link needs to be up). Press Ctrl-C to abort.
Waiting 2 seconds after link came up for switch to accept packets
Bit rate on interface to injection switch = 10000 (Mbps)
Requested bit rate to be generated on each switch port under test = 10000.00 (Mbps)
Not limiting frame rate, as bit-rate on interface to injection switch doesn't exceed the total across all switch ports under test
Writing per-port counts to 20221223T155846_per_port_counts_linux.csv
Test interval = 10 (secs)
Frame debug enabled = No
Sanity checks enabled = Yes
Press Ctrl-C to stop test at end of next test interval
Assertion failed : rx_pkt invalid : bad nb_segs

15:58:48.704
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
           37              0              0              0              0              0           -0.0          -0.00

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0
Max pending rx frames = 19 out of 1656

DPDK Ethernet statistics:
  Total number of successfully received packets    : 0
  Total number of successfully transmitted packets : 0
  Total number of successfully received bytes      : 0
  Total number of successfully transmitted bytes   : 0
  Total of Rx packets dropped by the HW            : 0
  Total number of erroneous received packets       : 0
  Total number of failed transmitted packets       : 0
  Total number of Rx mbuf allocation failures      : 0

"bad nb_segs" is reported because rx_pkt->nb_segs==2 but rx_pkt->next==NULL (meaning no next segment).
Therefore, doesn't doesn't appear to be dpdk_switch_test not having code to handle segmented frames.


8. I219-LM error free when not using huge pages
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[mr_halfword@skylake-alma release]$ sudo dpdk_switch_test/dpdk_switch_test --no-huge -m 1024m -l 3-4 -a 0000:00:1f.6 -- -p 25-26 -r 10000 -s
[sudo] password for mr_halfword: 
EAL: Detected CPU lcores: 8
EAL: Detected NUMA nodes: 1
EAL: Detected shared linkage of DPDK
EAL: Multi-process socket /var/run/dpdk/rte/mp_socket
EAL: Selected IOVA mode 'VA'
EAL: VFIO support initialized
EAL: Using IOMMU type 1 (Type 1)
EAL: Probe PCI driver: net_e1000_em (8086:15b7) device: 0000:00:1f.6 (socket 0)
TELEMETRY: No legacy callbacks, legacy socket not created
Using DPDK driver_name=net_e1000_em device_name=0000:00:1f.6
EAL: Error enabling MSI-X interrupts for fd 20
tx_num_descriptors : desired=2 actual=32
rx_num_descriptors : desired=3312 actual=3312
Waiting to get link speed (link needs to be up). Press Ctrl-C to abort.
Waiting 2 seconds after link came up for switch to accept packets
Bit rate on interface to injection switch = 1000 (Mbps)
Requested bit rate to be generated on each switch port under test = 10000.00 (Mbps)
Not limiting frame rate, as bit-rate on interface to injection switch doesn't exceed the total across all switch ports under test
Writing per-port counts to 20221223T222114_per_port_counts_linux.csv
Test interval = 10 (secs)
Frame debug enabled = No
Sanity checks enabled = Yes
Press Ctrl-C to stop test at end of next test interval

22:21:33.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806680         806651              0              0              0              0        80668.0         497.56

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:21:43.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806662              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:21:53.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806662              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:22:03.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806662              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:22:13.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806656         806661              0              0              0              0        80665.6         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:22:23.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806662              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:22:33.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806661              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:22:43.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806656         806660              0              0              0              0        80665.6         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:22:53.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806662              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:23:03.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806662              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:23:13.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806656         806662              0              0              0              0        80665.6         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:23:23.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806662              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:23:33.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806661              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:23:43.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806662              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:23:53.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806656         806661              0              0              0              0        80665.6         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:24:03.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806662              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:24:13.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806661              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:24:23.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806656         806662              0              0              0              0        80665.6         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:24:33.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806662              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:24:43.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806661              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:24:53.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806662              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:25:03.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806656         806662              0              0              0              0        80665.6         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:25:13.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806661              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:25:23.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806661              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:25:33.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806648         806650              0              0              0              0        80664.8         497.54

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:25:43.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806656         806661              0              0              0              0        80665.6         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:25:53.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806662              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:26:03.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806662              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

22:26:13.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806656         806656              0              0              0              0        80665.6         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0
^C
22:26:23.916
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       806664         806662              0              0              0              0        80666.4         497.55

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0
Max pending rx frames = 19 out of 1656

DPDK Ethernet statistics:
  Total number of successfully received packets    : 24199823
  Total number of successfully transmitted packets : 24199825
  Total number of successfully received bytes      : 36832130606
  Total number of successfully transmitted bytes   : 36832133650
  Total of Rx packets dropped by the HW            : 0
  Total number of erroneous received packets       : 0
  Total number of failed transmitted packets       : 0
  Total number of Rx mbuf allocation failures      : 0
EAL: Error disabling MSI-X interrupts for fd 20


9. QL41112HxCU-DE fails in the first iteration errors when not using huge pages
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

A run after increasing the mtu to avoid issues with receiving segmented. Sanity check no longer fails, but
after 696310 frames seems to get stuck and receive no more:
[mr_halfword@skylake-alma release]$ sudo dpdk_switch_test/dpdk_switch_test --no-huge -m 1024m -l 3-4 -a 0000:2d:00.1 -- -p 25-26 -r 10000 -s
[sudo] password for mr_halfword: 
EAL: Detected CPU lcores: 8
EAL: Detected NUMA nodes: 1
EAL: Detected shared linkage of DPDK
EAL: Multi-process socket /var/run/dpdk/rte/mp_socket
EAL: Selected IOVA mode 'VA'
EAL: VFIO support initialized
EAL: Using IOMMU type 1 (Type 1)
EAL: Ignore mapping IO port bar(1)
EAL: Ignore mapping IO port bar(3)
EAL: Ignore mapping IO port bar(5)
EAL: Probe PCI driver: net_qede (1077:8070) device: 0000:2d:00.1 (socket 0)
TELEMETRY: No legacy callbacks, legacy socket not created
Using DPDK driver_name=net_qede device_name=0000:2d:00.1
tx_num_descriptors : desired=2 actual=256
rx_num_descriptors : desired=3312 actual=4096
Waiting to get link speed (link needs to be up). Press Ctrl-C to abort.
Waiting 2 seconds after link came up for switch to accept packets
Bit rate on interface to injection switch = 10000 (Mbps)
Requested bit rate to be generated on each switch port under test = 10000.00 (Mbps)
Not limiting frame rate, as bit-rate on interface to injection switch doesn't exceed the total across all switch ports under test
Writing per-port counts to 20221223T232018_per_port_counts_linux.csv
Test interval = 10 (secs)
Frame debug enabled = No
Sanity checks enabled = Yes
Press Ctrl-C to stop test at end of next test interval

23:20:30.986
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8106114         696310              0              0              0        7406492       810611.4        4999.85

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   S
    26  S 
Total test intervals with failures = 1 : last failure NOW

23:20:40.986
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8106048              0              0              0              0        8106048       810604.8        4999.81

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   A
    26  A 
Total test intervals with failures = 2 : last failure NOW
^C
23:20:50.986
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8106057              0              0              0              0        8106057       810605.2        4999.81

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   A
    26  A 
Total test intervals with failures = 3 : last failure NOW
Max pending rx frames = 1656 out of 1656

DPDK Ethernet statistics:
  Total number of successfully received packets    : 696310
  Total number of successfully transmitted packets : 24318100
  Total number of successfully received bytes      : 1059783820
  Total number of successfully transmitted bytes   : 37012143634
  Total of Rx packets dropped by the HW            : 23621727
  Total number of erroneous received packets       : 0
  Total number of failed transmitted packets       : 0
  Total number of Rx mbuf allocation failures      : 23621727
[qede_drain_txq:964(2d:00.1:dpdk-port-0)]Tx queue[0] is stuck,requesting MCP to drain
[qede_drain_txq:973(2d:00.1:dpdk-port-0)]Timeout waiting for tx queue[0]:PROD=4363, CONS=11
[QEDE PMD: (2d:00.1:dpdk-port-0-0)]ecore_spq_block:Ramrod is stuck [CID ff100000 cmd 03 proto 04 echo 000d]
[qede_hw_err_notify:330(2d:00.1:dpdk-port-0-0)]HW error occurred [Ramrod Failure]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Calculating idle_chk and grcdump register length for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Total length = 2356504
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:obtaining idle_chk and grcdump for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check1 feature_size 2328
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check2 feature_size 2328
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["reg_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Reg fifo feature_size 5792
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["igu_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:IGU fifo feature_size 240
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["protection_override"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Protection override feature_size 2380
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["fw_asserts"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:FW assert feature_size 788
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["grc"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:GRC dump feature_size 2119996
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["mcp_trace"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_nvram_read:nvram_read: reading image of size 108336 bytes from NVRAM
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:MCP trace feature_size 14608
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_save_fw_dump:FW dump written to qede_pmd_dump_12-23-2022_23-20-57.bin file
[qede_stop_vport:458(2d:00.1:dpdk-port-0)]Stop V-PORT failed rc = -2
[QEDE PMD: (2d:00.1:dpdk-port-0-0)]ecore_spq_block:Ramrod is stuck [CID ff100000 cmd 02 proto 08 echo 000e]
[qede_hw_err_notify:330(2d:00.1:dpdk-port-0-0)]HW error occurred [Ramrod Failure]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Calculating idle_chk and grcdump register length for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Total length = 2356504
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:obtaining idle_chk and grcdump for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check1 feature_size 3240
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check2 feature_size 3240
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["reg_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Reg fifo feature_size 5792
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["igu_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:IGU fifo feature_size 240
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["protection_override"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Protection override feature_size 2380
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["fw_asserts"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:FW assert feature_size 788
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["grc"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:GRC dump feature_size 2119996
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["mcp_trace"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_nvram_read:nvram_read: reading image of size 108336 bytes from NVRAM
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:MCP trace feature_size 14624
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_save_fw_dump:FW dump written to qede_pmd_dump_12-23-2022_23-21-01.bin file
[QEDE PMD: (2d:00.1:dpdk-port-0-0)]ecore_hw_stop:Failed to close PF against FW [rc = -2]. Continue to stop HW to prevent illegal host access by the device.


10. QL41112HxCU-DE fails in the first iteration when using huge pages
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Same code as in 9) but using huge pages and reception still stalls during the original test iteration: 
[mr_halfword@skylake-alma ~]$ sudo dpdk-hugepages.py --pagesize 2048K --setup 1G
[sudo] password for mr_halfword:
[mr_halfword@skylake-alma release]$ sudo dpdk_switch_test/dpdk_switch_test -l 3-4 -a 0000:2d:00.1 -- -p 25-26 -r 10000 -s
EAL: Detected CPU lcores: 8
EAL: Detected NUMA nodes: 1
EAL: Detected shared linkage of DPDK
EAL: Multi-process socket /var/run/dpdk/rte/mp_socket
EAL: Selected IOVA mode 'VA'
EAL: No available 1048576 kB hugepages reported
EAL: VFIO support initialized
EAL: Using IOMMU type 1 (Type 1)
EAL: Ignore mapping IO port bar(1)
EAL: Ignore mapping IO port bar(3)
EAL: Ignore mapping IO port bar(5)
EAL: Probe PCI driver: net_qede (1077:8070) device: 0000:2d:00.1 (socket 0)
TELEMETRY: No legacy callbacks, legacy socket not created
Using DPDK driver_name=net_qede device_name=0000:2d:00.1
tx_num_descriptors : desired=2 actual=256
rx_num_descriptors : desired=3312 actual=4096
Waiting to get link speed (link needs to be up). Press Ctrl-C to abort.
Waiting 2 seconds after link came up for switch to accept packets
Bit rate on interface to injection switch = 10000 (Mbps)
Requested bit rate to be generated on each switch port under test = 10000.00 (Mbps)
Not limiting frame rate, as bit-rate on interface to injection switch doesn't exceed the total across all switch ports under test
Writing per-port counts to 20221223T232542_per_port_counts_linux.csv
Test interval = 10 (secs)
Frame debug enabled = No
Sanity checks enabled = Yes
Press Ctrl-C to stop test at end of next test interval

23:25:54.485
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8106129         569340              0              0              0        7533477       810612.9        4999.86

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   S
    26  S 
Total test intervals with failures = 1 : last failure NOW

23:26:04.485
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8106072              0              0              0              0        8106072       810607.2        4999.83

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   A
    26  A 
Total test intervals with failures = 2 : last failure NOW
^C
23:26:14.485
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8106037              0              0              0              0        8106037       810603.7        4999.80

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   A
    26  A 
Total test intervals with failures = 3 : last failure NOW
Max pending rx frames = 1656 out of 1656

DPDK Ethernet statistics:
  Total number of successfully received packets    : 569340
  Total number of successfully transmitted packets : 24318088
  Total number of successfully received bytes      : 866535480
  Total number of successfully transmitted bytes   : 37012123848
  Total of Rx packets dropped by the HW            : 23748684
  Total number of erroneous received packets       : 0
  Total number of failed transmitted packets       : 0
  Total number of Rx mbuf allocation failures      : 23748684
[qede_drain_txq:964(2d:00.1:dpdk-port-0)]Tx queue[0] is stuck,requesting MCP to drain
[qede_drain_txq:973(2d:00.1:dpdk-port-0)]Timeout waiting for tx queue[0]:PROD=4382, CONS=30
[QEDE PMD: (2d:00.1:dpdk-port-0-0)]ecore_spq_block:Ramrod is stuck [CID ff100000 cmd 03 proto 04 echo 000d]
[qede_hw_err_notify:330(2d:00.1:dpdk-port-0-0)]HW error occurred [Ramrod Failure]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Calculating idle_chk and grcdump register length for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Total length = 2356504
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:obtaining idle_chk and grcdump for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check1 feature_size 2328
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check2 feature_size 2328
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["reg_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Reg fifo feature_size 5792
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["igu_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:IGU fifo feature_size 240
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["protection_override"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Protection override feature_size 2380
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["fw_asserts"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:FW assert feature_size 788
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["grc"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:GRC dump feature_size 2119996
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["mcp_trace"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_nvram_read:nvram_read: reading image of size 108336 bytes from NVRAM
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:MCP trace feature_size 14668
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_save_fw_dump:FW dump written to qede_pmd_dump_12-23-2022_23-26-21.bin file
[qede_stop_vport:458(2d:00.1:dpdk-port-0)]Stop V-PORT failed rc = -2
[QEDE PMD: (2d:00.1:dpdk-port-0-0)]ecore_spq_block:Ramrod is stuck [CID ff100000 cmd 02 proto 08 echo 000e]
[qede_hw_err_notify:330(2d:00.1:dpdk-port-0-0)]HW error occurred [Ramrod Failure]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Calculating idle_chk and grcdump register length for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Total length = 2356504
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:obtaining idle_chk and grcdump for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check1 feature_size 3240
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check2 feature_size 3240
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["reg_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Reg fifo feature_size 5792
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["igu_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:IGU fifo feature_size 240
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["protection_override"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Protection override feature_size 2380
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["fw_asserts"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:FW assert feature_size 788
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["grc"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:GRC dump feature_size 2119996
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["mcp_trace"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_nvram_read:nvram_read: reading image of size 108336 bytes from NVRAM
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:MCP trace feature_size 14676
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_save_fw_dump:FW dump written to qede_pmd_dump_12-23-2022_23-26-24.bin file
[QEDE PMD: (2d:00.1:dpdk-port-0-0)]ecore_hw_stop:Failed to close PF against FW [rc = -2]. Continue to stop HW to prevent illegal host access by the device.


11. QL41112HxCU-DE fails in the first iteration when using huge pages and physical addresses
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Same code as in 9) but selecting physical addresses instead of virtual,
and reception still stalls during the original test iteration.

Statistic counters on the switch show shows the frames continued to be transmitted and passed back to
the QL41112HxCU-DE (which think means not flow-control related which is disabled in the switch).

In the device statistics:
a. "Total of Rx packets dropped by the HW" is the same as "Total number of Rx mbuf allocation failures"
b. The total number of missed frames is a few thousand different from the "Total of Rx packets dropped by the HW"

This sugguests something goes wrong such that receive descriptors are not being serviced.

[mr_halfword@skylake-alma release]$ sudo dpdk_switch_test/dpdk_switch_test --iova=pa -l 3-4 -a 0000:2d:00.1 -- -p 25-26 -r 10000 -s
EAL: Detected CPU lcores: 8
EAL: Detected NUMA nodes: 1
EAL: Detected shared linkage of DPDK
EAL: Multi-process socket /var/run/dpdk/rte/mp_socket
EAL: Selected IOVA mode 'PA'
EAL: No available 1048576 kB hugepages reported
EAL: VFIO support initialized
EAL: Using IOMMU type 1 (Type 1)
EAL: Ignore mapping IO port bar(1)
EAL: Ignore mapping IO port bar(3)
EAL: Ignore mapping IO port bar(5)
EAL: Probe PCI driver: net_qede (1077:8070) device: 0000:2d:00.1 (socket 0)
TELEMETRY: No legacy callbacks, legacy socket not created
Using DPDK driver_name=net_qede device_name=0000:2d:00.1
tx_num_descriptors : desired=2 actual=256
rx_num_descriptors : desired=3312 actual=4096
Waiting to get link speed (link needs to be up). Press Ctrl-C to abort.
Waiting 2 seconds after link came up for switch to accept packets
Bit rate on interface to injection switch = 10000 (Mbps)
Requested bit rate to be generated on each switch port under test = 10000.00 (Mbps)
Not limiting frame rate, as bit-rate on interface to injection switch doesn't exceed the total across all switch ports under test
Writing per-port counts to 20221223T232956_per_port_counts_linux.csv
Test interval = 10 (secs)
Frame debug enabled = No
Sanity checks enabled = Yes
Press Ctrl-C to stop test at end of next test interval

23:30:08.919
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8106125         606200              0              0              0        7496613       810612.5        4999.86

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   S
    26  S 
Total test intervals with failures = 1 : last failure NOW

23:30:18.919
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8106084              0              0              0              0        8106084       810608.4        4999.83

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   A
    26  A 
Total test intervals with failures = 2 : last failure NOW
^C
23:30:28.919
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
      8106048              0              0              0              0        8106048       810604.8        4999.81

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   A
    26  A 
Total test intervals with failures = 3 : last failure NOW
Max pending rx frames = 1656 out of 1656

DPDK Ethernet statistics:
  Total number of successfully received packets    : 606200
  Total number of successfully transmitted packets : 24318094
  Total number of successfully received bytes      : 922636400
  Total number of successfully transmitted bytes   : 37012134502
  Total of Rx packets dropped by the HW            : 23711828
  Total number of erroneous received packets       : 0
  Total number of failed transmitted packets       : 0
  Total number of Rx mbuf allocation failures      : 23711828
[qede_drain_txq:964(2d:00.1:dpdk-port-0)]Tx queue[0] is stuck,requesting MCP to drain
[qede_drain_txq:973(2d:00.1:dpdk-port-0)]Timeout waiting for tx queue[0]:PROD=4400, CONS=48
[QEDE PMD: (2d:00.1:dpdk-port-0-0)]ecore_spq_block:Ramrod is stuck [CID ff100000 cmd 03 proto 04 echo 000d]
[qede_hw_err_notify:330(2d:00.1:dpdk-port-0-0)]HW error occurred [Ramrod Failure]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Calculating idle_chk and grcdump register length for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Total length = 2356504
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:obtaining idle_chk and grcdump for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check1 feature_size 3164
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check2 feature_size 3164
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["reg_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Reg fifo feature_size 5952
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["igu_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:IGU fifo feature_size 240
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["protection_override"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Protection override feature_size 2380
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["fw_asserts"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:FW assert feature_size 788
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["grc"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:GRC dump feature_size 2119996
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["mcp_trace"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_nvram_read:nvram_read: reading image of size 108336 bytes from NVRAM
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:MCP trace feature_size 14652
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_save_fw_dump:FW dump written to qede_pmd_dump_12-23-2022_23-30-35.bin file
[qede_stop_vport:458(2d:00.1:dpdk-port-0)]Stop V-PORT failed rc = -2
[ecore_int_deassertion_aeu_bit:1000(2d:00.1:dpdk-port-0-0)]`GRC' - Disabled future attentions
[QEDE PMD: (2d:00.1:dpdk-port-0-0)]ecore_spq_block:Ramrod is stuck [CID ff100000 cmd 02 proto 08 echo 000e]
[qede_hw_err_notify:330(2d:00.1:dpdk-port-0-0)]HW error occurred [Ramrod Failure]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Calculating idle_chk and grcdump register length for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Total length = 2356504
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:obtaining idle_chk and grcdump for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check1 feature_size 4076
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check2 feature_size 3816
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["reg_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Reg fifo feature_size 5792
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["igu_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:IGU fifo feature_size 240
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["protection_override"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Protection override feature_size 2380
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["fw_asserts"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:FW assert feature_size 788
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["grc"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:GRC dump feature_size 2119996
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["mcp_trace"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_nvram_read:nvram_read: reading image of size 108336 bytes from NVRAM
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:MCP trace feature_size 14672
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_save_fw_dump:FW dump written to qede_pmd_dump_12-23-2022_23-30-38.bin file
[QEDE PMD: (2d:00.1:dpdk-port-0-0)]ecore_hw_stop:Failed to close PF against FW [rc = -2]. Continue to stop HW to prevent illegal host access by the device.


12. QL41112HxCU-DE error free when using a 200M rate, and secure boot enabled
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The above tests were done with secure boot disabled.

After enabling secure boot DPDK was still able to bind the vfio-pci module to the network devices.
The following was an error free run, not using huge pages, when using a 200M rate to avoid the reception stalling: 
[mr_halfword@skylake-alma release]$ sudo dpdk_switch_test/dpdk_switch_test --no-huge -m 1024m -l 3-4 -a 0000:2d:00.1 -- -p 25-26 -r 100 -s 
EAL: Detected CPU lcores: 8
EAL: Detected NUMA nodes: 1
EAL: Detected shared linkage of DPDK
EAL: Multi-process socket /var/run/dpdk/rte/mp_socket
EAL: Selected IOVA mode 'VA'
EAL: VFIO support initialized
EAL: Using IOMMU type 1 (Type 1)
EAL: Ignore mapping IO port bar(1)
EAL: Ignore mapping IO port bar(3)
EAL: Ignore mapping IO port bar(5)
EAL: Probe PCI driver: net_qede (1077:8070) device: 0000:2d:00.1 (socket 0)
TELEMETRY: No legacy callbacks, legacy socket not created
Using DPDK driver_name=net_qede device_name=0000:2d:00.1
tx_num_descriptors : desired=2 actual=256
rx_num_descriptors : desired=3312 actual=4096
Waiting to get link speed (link needs to be up). Press Ctrl-C to abort.
Waiting 2 seconds after link came up for switch to accept packets
Bit rate on interface to injection switch = 10000 (Mbps) as read using DPDK
Requested bit rate to be generated on each switch port under test = 100.00 (Mbps)
Limiting max frame rate to 16212.7 Hz, as bit-rate on interface to injection switch exceeds that across all switch ports under test
Writing per-port counts to 20221225T210501_per_port_counts_linux.csv
Test interval = 10 (secs)
Frame debug enabled = No
Sanity checks enabled = Yes
Press Ctrl-C to stop test at end of next test interval

21:05:13.777
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       162128         162127              0              0             51              0        16212.8         100.00

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0

21:05:23.777
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       162127         162127              0              0             45              0        16212.7         100.00

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0
<<snip>>

21:46:03.777
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       162127         162127              0              0             15              0        16212.7         100.00

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0
^C
21:46:13.777
      Tx Test        Rx Test  Rx Unexpected     Rx Flooded       Rx Other  missed frames   tx rate (Hz)  per port Mbps
       162127         162127              0              0             15              0        16212.7         100.00

Summary of missed frames : '.' none missed 'S' some missed 'A' all missed
Source  Destination ports --->
  port  22
        56
    25   .
    26  . 
Total test intervals with failures = 0
Max pending rx frames = 2 out of 1656

DPDK Ethernet statistics:
  Total number of successfully received packets    : 40051225
  Total number of successfully transmitted packets : 40045396
  Total number of successfully received bytes      : 60950094931
  Total number of successfully transmitted bytes   : 60949092712
  Total of Rx packets dropped by the HW            : 0
  Total number of erroneous received packets       : 0
  Total number of failed transmitted packets       : 0
  Total number of Rx mbuf allocation failures      : 0
[qede_drain_txq:964(2d:00.1:dpdk-port-0)]Tx queue[0] is stuck,requesting MCP to drain
[qede_drain_txq:973(2d:00.1:dpdk-port-0)]Timeout waiting for tx queue[0]:PROD=2900, CONS=84
[QEDE PMD: (2d:00.1:dpdk-port-0-0)]ecore_fw_assertion:FW assertion!
[qede_hw_err_notify:330(2d:00.1:dpdk-port-0-0)]HW error occurred [FW Assertion]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Calculating idle_chk and grcdump register length for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Total length = 2356504
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:obtaining idle_chk and grcdump for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check1 feature_size 2040
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check2 feature_size 2040
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["reg_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Reg fifo feature_size 240
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["igu_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:IGU fifo feature_size 240
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["protection_override"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Protection override feature_size 2380
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["fw_asserts"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:FW assert feature_size 788
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["grc"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:GRC dump feature_size 2119996
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["mcp_trace"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_nvram_read:nvram_read: reading image of size 108336 bytes from NVRAM
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:MCP trace feature_size 14624
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_save_fw_dump:FW dump written to qede_pmd_dump_12-25-2022_21-46-17.bin file
[QEDE PMD: (2d:00.1:dpdk-port-0-0)]ecore_int_deassertion_aeu_bit:`General Attention 32': Fatal attention
[qede_hw_err_notify:330(2d:00.1:dpdk-port-0-0)]HW error occurred [HW Attention]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Calculating idle_chk and grcdump register length for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Total length = 2356504
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:obtaining idle_chk and grcdump for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check1 feature_size 2328
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check2 feature_size 2328
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["reg_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Reg fifo feature_size 5792
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["igu_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:IGU fifo feature_size 240
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["protection_override"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Protection override feature_size 2380
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["fw_asserts"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:FW assert feature_size 788
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["grc"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:GRC dump feature_size 2119996
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["mcp_trace"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_nvram_read:nvram_read: reading image of size 108336 bytes from NVRAM
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:MCP trace feature_size 14624
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_save_fw_dump:FW dump written to qede_pmd_dump_12-25-2022_21-46-17.bin file
[ecore_int_deassertion_aeu_bit:1000(2d:00.1:dpdk-port-0-0)]`General Attention 32' - Disabled future attentions
[QEDE PMD: (2d:00.1:dpdk-port-0-0)]ecore_spq_block:Ramrod is stuck [CID ff100000 cmd 03 proto 04 echo 000d]
[qede_hw_err_notify:330(2d:00.1:dpdk-port-0-0)]HW error occurred [Ramrod Failure]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Calculating idle_chk and grcdump register length for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Total length = 2356504
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:obtaining idle_chk and grcdump for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check1 feature_size 2328
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check2 feature_size 2328
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["reg_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Reg fifo feature_size 5792
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["igu_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:IGU fifo feature_size 240
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["protection_override"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Protection override feature_size 2380
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["fw_asserts"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:FW assert feature_size 788
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["grc"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:GRC dump feature_size 2119996
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["mcp_trace"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_nvram_read:nvram_read: reading image of size 108336 bytes from NVRAM
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:MCP trace feature_size 14740
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_save_fw_dump:FW dump written to qede_pmd_dump_12-25-2022_21-46-21.bin file
[qede_stop_vport:458(2d:00.1:dpdk-port-0)]Stop V-PORT failed rc = -2
[QEDE PMD: (2d:00.1:dpdk-port-0-0)]ecore_spq_block:Ramrod is stuck [CID ff100000 cmd 02 proto 08 echo 000e]
[qede_hw_err_notify:330(2d:00.1:dpdk-port-0-0)]HW error occurred [Ramrod Failure]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Calculating idle_chk and grcdump register length for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs_len:Total length = 2356504
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:obtaining idle_chk and grcdump for current engine
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check1 feature_size 3240
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["idle_chk"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Idle Check2 feature_size 3240
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["reg_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Reg fifo feature_size 5792
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["igu_fifo"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:IGU fifo feature_size 240
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["protection_override"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:Protection override feature_size 2380
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["fw_asserts"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:FW assert feature_size 788
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["grc"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:GRC dump feature_size 2119996
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_dbg_dump:Collecting a debug feature ["mcp_trace"]
[QEDE PMD: (2d:00.1:dpdk-port-0)]qed_nvram_read:nvram_read: reading image of size 108336 bytes from NVRAM
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_get_regs:MCP trace feature_size 14872
[QEDE PMD: (2d:00.1:dpdk-port-0)]qede_save_fw_dump:FW dump written to qede_pmd_dump_12-25-2022_21-46-24.bin file
[QEDE PMD: (2d:00.1:dpdk-port-0-0)]ecore_hw_stop:Failed to close PF against FW [rc = -2]. Continue to stop HW to prevent illegal host access by the device.
